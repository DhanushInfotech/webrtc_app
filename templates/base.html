<!doctype html>
<html>
<head>
  <title>{{ title }}</title>
  <meta charset="utf-8">
  <link href="static/rtc-lib/chat.css" rel="stylesheet">
  <script src="static/rtc-lib/web_socket.js"> </script>
  <script type="text/javascript" src="static/rtc-lib/chatclient.js"></script>
  <script src="static/rtc-lib/adapter.js"></script>
</head>
<body>
  <div id="container" class="flexChild columnParent">
    <div class="flexChild rowParent" id="feedback-container">
      <div class="flexChild" id="camera-container">
        <div class="camera-box">
          <video id="received_video" autoplay></video>
          <video id="local_video" autoplay="autoplay" muted="muted"></video>
          <button id="hangup-button" onclick="hangUpCall();" disabled="disabled">
            Hang Up
          </button>
        </div>
      </div>
       <div class="flexChild" id="chat-container">
          <iframe id="chatbox" srcdoc="<body><p>{% if title == 'Caller' %}Waiting for {{peer_id}} to come online...
          {%else%} Welcome!{% end %}</p></body>"></iframe>
        </div>
    </div>
    <br />
    <br />
    <div class="flexChild rowParent" id="control-row">
      <div class="flexChild" id="empty-container"></div>
      <div class="flexChild" id="chat-controls-container">
        Chat: <input id="text" type="text" name="text" size="80" maxlength="256"
          placeholder="Chat with {{peer_id}}!" autocomplete="off" onkeyup="handleKey(event)"
          disabled="disabled">
        <button id="send" onclick=handleSendButton disabled="disabled">Send</button>
      </div>
    </div>
  </div>
	<script type="text/javascript">
		(function() {
		    {% if title == 'Caller' %}
			    connect('{% raw caller_ws_uri %}', '{{my_id}}', '{{peer_id}}', false);
			{%else%}
			    connect('{% raw recieve_ws_uri %}', '{{my_id}}', '{{peer_id}}', true);
			{% end %}
			var w = window.innerWidth
                || document.documentElement.clientWidth
                || document.body.clientWidth;

            var h = window.innerHeight
                || document.documentElement.clientHeight
                || document.body.clientHeight;
            container = document.getElementById('container');
            container.style.width = 0.98*w + 'px';
            container.style.height = 0.95*h + 'px';
		})();
	</script>
</body>
</html>